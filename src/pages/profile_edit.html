<!DOCTYPE html>
<script type="module">
  import {WideSideLayout} from '/src/components/layouts/Wide+Side.js';
  import {Form} from '/src/components/forms/Form.js';
  import {StandardButton as Button} from '/src/components/forms/StandardButton.js';
  import {RowInput as Input} from '/src/components/forms/RowInput.js';
  import {RowLink as Link} from '/src/components/forms/RowLink.js';
  import {AvatarPic} from '/src/components/forms/Avatar.js';
  import {JSONWrapper} from '/src/modules/Utils.js';

  const view = new WideSideLayout({
    title: 'Изменить данные',
    backButtonLink: 'profile.html',
    Form, Button, Input, Link, AvatarPic
  });

  view.props.contents = `%{ Form({ "name": "profile", "action": "" }) }%`;
  
  const userData = {
    email: 'pochta@yandex.ru',
    login: 'ivanovivan',
    first_name: 'Иван',
    second_name: 'Иванов',
    display_name: 'Ivan Ivanov',
    phone: '+7-777-777-7777'
  };

  let inputs = [
    { name: 'email', type: 'email', label: 'Почта' },
    { name: 'login', type: 'text', label: 'Логин' },
    { name: 'first_name', type: 'text', label: 'Имя' },
    { name: 'second_name', type: 'text', label: 'Фамилия' },
    { name: 'display_name', type: 'text', label: 'Имя в чате' },
    { name: 'phone', type: 'tel', label: 'Телефон' }
  ];

  for (const input of inputs) {
    input.value = userData[input.name];
  }

  inputs = JSONWrapper.stringify(inputs);

  view.props.fieldset = () => `
    %{ AvatarPic }%
    %{ Input(${inputs}...) }%
    <br><br><br>
    %{ Button({ "name": "submit", "type": "submit", "label": "Сохранить" }) }%
    <br><br>
  `;

  view.renderToBody();

</script>
